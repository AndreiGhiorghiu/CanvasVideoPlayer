var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,o=(e,t)=>{for(var a in t||(t={}))s.call(t,a)&&i(e,a,t[a]);if(n)for(var a of n(t))r.call(t,a)&&i(e,a,t[a]);return e};import{R as c,r as l,c as m,a as d,K as u,b as p}from"./vendor.0e646860.js";var v="_panel_1b7pa_1",g="_stack_1b7pa_6",E="_stack_views_1b7pa_13",f="_view_1b7pa_33";function h(e){return c.createElement("div",{className:`mvc_sb-view ${e.className} ${f}`,style:e.style},e.children)}function _(e){return c.createElement("div",{className:`mvc_sb-panel ${v} ${e.className}`},e.children)}_.Stack=function(e){const t=[];c.Children.forEach(e.children,(e=>{e&&e.type&&e.type.prototype&&e.type.prototype.constructor===h&&t.push(e)}));const a=t.length,n=t.map((e=>e.props.name)).indexOf(e.visible),s=n>=0?n:0,r={width:100*a+"%",marginLeft:`-${100*s}%`};return c.createElement("div",{className:`mvc_sb-stack mvc_sb-stack-${e.visible} ${g}`},c.createElement("div",{className:`mvc_sb-stack-container ${E}`,style:r},t.map(((e,t)=>{const n={width:100/a+"%",height:s===t?"auto":"0px"},r=s===t?"active mvc_sb-view-active":"inactive mvc_sb-view-inactive";return c.cloneElement(e,{style:n,key:t,className:r})}))))},_.View=h;var b="_sidebar_1gtwd_2",y=({view:e,children:t})=>c.createElement("nav",{className:`navbar navbar-vertical fixed-left navbar-expand-md navbar-light ${b}`},c.createElement(_.Stack,{visible:e},t.map(((e,t)=>{return c.createElement(_.View,{key:t,name:e.props.name},c.createElement("div",null,c.createElement("div",{className:"header-body"},c.createElement("div",{className:"row align-items-center"},c.createElement("div",{className:"col"},c.createElement("h6",{className:"header-pretitle"},"Media Editor"),c.createElement("h1",{className:"header-title"},e.props.title)),(a=e.props.back)?c.createElement("div",{className:"col-auto"},c.createElement("span",{className:"fe fe-activity"}),c.createElement("button",{className:"btn btn-sm btn-white",onClick:()=>a()},"Back")):null))),e);var a}))));var w="_editor_8paqc_9",x=({view:e,children:t})=>c.createElement("div",{className:`main-content ${w}`},c.createElement(_.Stack,{visible:e},t.map(((e,t)=>c.createElement(_.View,{key:t,name:e.props.name},e))))),S=e=>{const t=o({},e);return delete t.children,l.exports.Children.map(e.children,(e=>(t.className+=" "+e.props.className||"",l.exports.cloneElement(e,o({},t)))))};var N="_zone_mcqpi_1",k="_leftPlaceholder_mcqpi_6",$="_frame_mcqpi_15",C="_rightPlaceholder_mcqpi_22";const[D,I]=m(((e,t)=>({currentHover:null,placeholderPosition:!0})));var j=e=>{const[t,a]=l.exports.useState(!1),n=new Image;return"video"===e.data.type?n.src="/assets/images/film.svg":"audio"===e.data.type?n.src="/assets/images/music.svg":n.src="/assets/images/image.svg",c.createElement(S,{draggable:!0,onDragStart:function(t){var s;t.dataTransfer.setData("data",JSON.stringify({id:e.id,source:e.source,index:e.index,data:e.data}));var r=null==(s=null==navigator?void 0:navigator.userAgent)?void 0:s.toLowerCase();-1!=r.indexOf("safari")&&r.indexOf("chrome")>-1&&(n.width="5",t.dataTransfer.setDragImage(n,5,5)),I.setState({currentAttr:o({},e)}),a(!0)},onDragEnd:function(e){a(!1),I.setState({currentAttr:null})},attr:e.attr},e.children)};let P=null;var T=e=>{const{currentHover:n,placeholderPosition:s}=D(),[r,i]=l.exports.useState(!1);function m(t,a){return!I.getState().currentAttr.data.type.includes(t)||!e.droppableid.includes(a)}function d(){return!!I.getState().currentAttr&&(m("image","audio")&&m("video","audio")&&!!m("audio","video")||(i(!1),!1))}let u=n===e.component;const p=l.exports.useCallback((()=>{if(event.preventDefault(),!d())return!1;if(!("null"===e.component.split("-")[0])){const e=event.target.getBoundingClientRect().x,t=parseInt(event.target.clientWidth/2);event.clientX<e+t?I.setState({placeholderPosition:!0}):I.setState({placeholderPosition:!1})}P&&clearTimeout(P),u||I.setState({currentHover:e.component})}),[event]);return c.createElement(S,{className:`${N} ${u&&(s?k:C)||""} ${r?$:""}`,onDragEnter:t=>function(t){if(P&&clearTimeout(P),!d())return!1;I.setState({currentHover:e.component}),t.persist()}(t),onDragLeave:e=>(P&&clearTimeout(P),void(P=setTimeout((()=>{I.setState({currentHover:null})}),800))),onDragOver:e=>p(e),onDrop:n=>function(n){if(n.preventDefault(),n.stopPropagation(),I.setState({currentHover:null}),!d())return!1;const{data:r,source:i,index:c}=JSON.parse(n.dataTransfer.getData("data"));var l,m;e.onDragEnd&&e.onDragEnd({element:(l=o({},r),m={source:i,index:c},t(l,a(m))),to:e,left:s})}(n)},e.children)};var O={media:{images:[{src:"assets/images/media-editor/img1.jpg",thumb:"assets/images/media-editor/img1-thumb.jpg"},{src:"assets/images/media-editor/img2.jpg",thumb:"assets/images/media-editor/img2-thumb.jpg"},{src:"assets/images/media-editor/img3.webp",thumb:"assets/images/media-editor/img3-thumb.jpg"},{src:"assets/images/media-editor/img4.jpg",thumb:"assets/images/media-editor/img4-thumb.jpg"},{src:"assets/images/media-editor/img5.webp",thumb:"assets/images/media-editor/img5-thumb.jpg"}],videos:[{src:"assets/images/media-editor/video1.mp4",poster:"assets/images/media-editor/video1.png"},{src:"assets/images/media-editor/video3.mp4",poster:"assets/images/media-editor/video3.png"},{src:"assets/images/media-editor/video4.mp4",poster:"assets/images/media-editor/video4.png"}],audios:[{src:"assets/images/media-editor/Ben E. King - part 1.mp3"},{src:"assets/images/media-editor/Ben E. King - part 2.mp3"},{src:"assets/images/media-editor/Ben E. King - part 3.mp3"}]},scenes:[{src:"assets/images/media-editor/video3.mp4",poster:"assets/images/media-editor/video3.png",id:"test2",type:"video",loop:15},{src:"assets/images/media-editor/img1.jpg",id:"test1",type:"image",loop:2},{src:"assets/images/media-editor/video1.mp4",poster:"assets/images/media-editor/video1.png",id:"test3",type:"video",loop:5}],audio:[{src:"assets/images/media-editor/Ben E. King - part 1.mp3",name:"Ben E. King - part 1",id:"audio1",type:"audio",loop:8},{src:"assets/images/media-editor/Ben E. King - part 3.mp3",name:"Ben E. King - part 3",id:"audio3",type:"audio",loop:9}]};const[A,V]=m(((e,t)=>({scenes:O.scenes||[],audio:O.audio||[],getVideoData:e=>new Promise(((t,a)=>{const n=document.createElement("video");n.src=e,n.ondurationchange=e=>t({duration:e.path[0].duration})})),getAudioData:e=>new Promise(((t,a)=>{const n=document.createElement("audio");n.src=e,n.ondurationchange=e=>t({duration:e.path[0].duration})})),async setScenes(a,n=!0){const{scenes:s,getVideoData:r}=t();if("video"===a.type){const e=await r(a.src);a.loop=e.duration}else a.loop=5;return a.id=d(),n&&(s.push(a),e({scenes:s})),a},async setAudioScenes(a,n=!0){const{audio:s,getAudioData:r}=t();if("audio"===a.type){const e=await r(a.src);a.loop=e.duration}else a.loop=5;return a.id=d(),n&&(s.push(a),e({audio:s})),a},async moveScenes(a,n,s){const{scenes:r,setScenes:i}=t();let o=r[a.index];"sidebar"===a.source?o=await i(a,!1):r.splice(a.index,1),n?r.splice(s.index,0,o):r.splice(s.index+1,0,o),e({scenes:r})},async moveAudioScenes(a,n,s){const{audio:r,setAudioScenes:i}=t();let o=r[a.index];"sidebar"===a.source?o=await i(a,!1):r.splice(a.index,1),console.log(o),n?r.splice(s.index,0,o):r.splice(s.index+1,0,o),e({audio:r})},updateScene(a,n){const{scenes:s}=t(),r=s.map((e=>e.id===a?o(o({},e),n):e));e({scenes:r})}})));function z(e){return new Date(1e3*e).toISOString().substr(14,5)}var M={videoTimeline:"_videoTimeline_1jev7_1",mediasContainer:"_mediasContainer_1jev7_7",title:"_title_1jev7_11",scenes:"_scenes_1jev7_17",mediaScene:"_mediaScene_1jev7_25",scenesContainer:"_scenesContainer_1jev7_36",info:"_info_1jev7_54",mediaSceneContainer:"_mediaSceneContainer_1jev7_61",expand:"_expand_1jev7_61",remove:"_remove_1jev7_62",audioScene:"_audioScene_1jev7_101"};const[B,L]=m(((e,t)=>({view:"dashboard",scene:null,setView(t){e({view:t})},setEditScene(t){e({scene:t})}})));var q=()=>{const{scenes:e,setScenes:t,moveScenes:a,updateScene:n}=A();function s(e){"frame"===e.to.component?t(e.element):a(e.element,e.left,e.to)}function r(e){return c.createElement("div",{className:M.expand,draggable:!0,onDrag:t=>function(e,t){const a=e.clientX,n=document.querySelector(`[scene-ref=${t}]`),s=parseInt(n.style.minWidth.replace("px")),r=n.getBoundingClientRect().x+s;n.style.minWidth=s+a-r+"px"}(t,e),onDragEnd:t=>function(e,t){const a=document.querySelector(`[scene-ref=${t}]`),s=parseInt(a.style.minWidth.replace("px"));n(t,{loop:s/15})}(0,e),onClick:e=>{e.preventDefault(),e.stopPropagation()}},c.createElement("img",{src:"/video-player/arrows-alt-h.svg"}))}return c.createElement("div",{className:M.mediasContainer},c.createElement("div",{className:M.title},"Media:"),c.createElement("div",{className:M.scenesContainer},c.createElement("div",{className:M.scenes},function(){let t=0,a=0;return e.map(((n,i)=>{const o=e[i-1];return t+=o&&Math.floor(o.loop)||0,a=t+Math.floor(n.loop-1),e.length-1===parseInt(i)&&(a=t+Math.floor(n.loop)),c.createElement("div",{className:M.scene,key:n.id},c.createElement(T,{component:`frame-${n.id}`,droppableid:`video-${n.id}`,index:i,onDragEnd:e=>s(e)},c.createElement("div",{className:M.mediaSceneContainer},c.createElement("div",{className:M.info},c.createElement("span",null,z(t)),c.createElement("span",null,z(a))),c.createElement(j,{data:n,source:"timeline",index:i},c.createElement("div",{className:M.mediaScene,"scene-ref":n.id,onClick:e=>{"video"!==n.type&&function(e){L.getState().setView("photo"),L.getState().setEditScene(e)}(n)},style:{backgroundImage:`url(${"video"===n.type&&n.poster||n.src})`,minWidth:15*n.loop+"px"}})),"video"!==n.type&&r(n.id))))}))}(),c.createElement(T,{component:"frame",droppableid:"video",index:null,onDragEnd:e=>s(e)},c.createElement("div",null)))))},K=e=>{const{audio:t,setAudioScenes:a,moveAudioScenes:n}=A();function s(e){const t=e.element.src.slice(e.element.src.lastIndexOf("/")+1,e.element.src.length-4);e.element.name=t,"frame"===e.to.component?a(e.element):n(e.element,e.left,e.to)}return c.createElement("div",{className:M.mediasContainer},c.createElement("div",{className:M.title},"Audio:"),c.createElement("div",{className:M.scenesContainer},c.createElement("div",{className:M.scenes},function(){let e=0,a=0;return t.map(((n,r)=>{const i=t[r-1];return e+=i&&Math.floor(i.loop)||0,a=e+Math.floor(n.loop-1),t.length-1===parseInt(r)&&(a=e+Math.floor(n.loop)),c.createElement("div",{className:M.scene,key:n.id},c.createElement(T,{component:`frame-${n.id}`,droppableid:`audio-${n.id}`,index:r,onDragEnd:e=>s(e)},c.createElement("div",null,c.createElement("div",{className:M.info},c.createElement("span",null,z(e)),c.createElement("span",null,z(a))),c.createElement(j,{data:n,source:"timeline",index:r},c.createElement("div",{className:`${M.mediaScene} ${M.audioScene}`,style:{minWidth:15*n.loop+"px"}},n.name)))))}))}(),c.createElement(T,{component:"frame",droppableid:"audio",index:null,onDragEnd:e=>s(e)},c.createElement("div",null)))))},R=e=>c.createElement("div",{className:M.videoTimeline},c.createElement(q,null),c.createElement(K,null));var H="_videoContainer_1jcnm_13";var W="_play_mez02_49",F="_buttons_mez02_6",G="_stage_mez02_12",J="_seconds_mez02_19",X="_actions_mez02_25",U="_videoPlayer_mez02_38",Q="_timeBar_mez02_42",Y="_secondsRange_mez02_45",Z="_playPause_mez02_49";let ee=0,te=!1,ae=[];var ne=(e,t)=>{const[a,n]=l.exports.useState(null),[s,r]=l.exports.useState(ee),[i,o]=l.exports.useState([]),[c,m]=l.exports.useState([]),[d,p]=l.exports.useState(!1),[v,g]=l.exports.useState(null);l.exports.useEffect((()=>E()),[]),l.exports.useEffect((()=>function(){if(!a)return;const n=e.map(((t,a)=>e.reduce(((e,t,n)=>e+(n<=a&&t.loop)||0),0))),s=t.map(((e,a)=>t.reduce(((e,t,n)=>e+(n<=a&&t.loop)||0),0)));m(s),o(n),a.find(".video-player")[0]&&a.find(".video-player")[0].destroy();const i=new u.Layer({name:"video-player"});a.add(i);for(const t of e){const e=new u.Group({name:t.id});let a;i.add(e),a="image"===t.type?_(t):f(t),e.add(a),i.draw()}ae=[];for(const e of t){const t=h(e);ae.push({element:t,id:e.id})}const c=new u.Animation((t=>{if(!e.length)return;ee+=t.timeDiff/1e3,r(ee);const i=b(n,s);if(!te){ae.length&&ae.forEach((({element:e})=>e.pause()));const t=a.find(`.${e[0].id}`)[0];if(t.zIndex(e.length-1),"video"===e[0].type){const e=t.find("Image")[0].attrs.image;i||(e.currentTime=0),e.pause(),setTimeout((()=>a.draw()),50)}c.stop(),te=!1}}),a);g(c)}()),[e,a]),l.exports.useEffect((()=>p(te)),[te]);const E=()=>{const e=new u.Stage({container:`.${G}`,width:500,height:500}),t=new u.Layer({name:"background"});e.add(t);const a=new u.Rect({fill:"#000",width:500,height:500});t.add(a),n(e),e.draw()},f=e=>{var t=document.createElement("video");t.src=e.src;const a=new u.Image({image:t,name:"element",x:0,y:0,width:500,height:500});return a.attrs.image.muted=!0,a},h=e=>{const t=document.createElement("audio");return t.src=e.src,t},_=e=>{var t=document.createElement("img");t.src=e.src;return new u.Image({image:t,name:"element",x:0,y:0,width:500,height:500})};function b(t,n,s=!1){a.find(".background")[0].zIndex(0);const i=t.findIndex((e=>e>=ee)),o=n.findIndex((e=>e>=ee)),c=t[i-1]||0,l=e[i-1]||e[e.length-1],m=e[i];if(-1===i){if(a.find(".background")[0].zIndex(1),r(0),ee=0,l&&"video"===l.type){a.find(`.${l.id}`)[0].find("Image")[0].attrs.image.pause()}return!1}const d=a.find(`.${m.id}`)[0];if(d.zIndex(e.length-1),l&&"video"===l.type){a.find(`.${l.id}`)[0].find("Image")[0].attrs.image.pause()}if(ae.length&&-1!==o){const e=n[o-1]||0,t=ee-e,a=ae[o].element;a.paused&&!s&&(ae.forEach((e=>e.element.pause())),a.play()),s&&(a.currentTime=t);const r=ae[o-1];r&&r.element.pause()}if("video"===m.type){const e=ee-c,t=d.find("Image")[0].attrs.image;t.paused&&!s&&t.play(),s&&(t.currentTime=e)}return!0}return{seconds:s,onChange:function(e){r(e),ee=e,b(i,c,!0),a.draw()},isPlaying:d,togglePlaying:function(){v.isRunning()?(te=!1,setTimeout((()=>v.stop()),100)):(te=!0,v.start())}}},se=({scenes:e,audio:t})=>{const{seconds:a,onChange:n,isPlaying:s,togglePlaying:r}=ne(e,t),i=e.reduce(((e,t)=>e+t.loop),0);return l.exports.useEffect((()=>{s&&r()}),[e]),c.createElement("div",{"data-seconds":`${a}`},c.createElement("div",{className:U},c.createElement("div",{className:G}),c.createElement("div",{className:X},c.createElement("div",{className:F},c.createElement("div",{id:W,className:"cvs-action cvs-play",onClick:r},c.createElement("img",{className:Z,src:`video-player/${s?"pause":"play"}.svg`}))),c.createElement("div",{className:Q},c.createElement("div",{className:J},c.createElement("span",null,z(a)),c.createElement("span",null,z(i))),c.createElement("input",{className:Y,type:"range",value:a,onChange:e=>{n(parseFloat(e.target.value))},min:0,step:.01,max:i})))))},re=e=>c.createElement(se,{scenes:e.scenes,audio:e.audio});var ie="_tabs_1mkq5_1";function oe({view:e,setView:t,children:a}){return a.map(((a,n)=>c.createElement("button",{key:n,type:"button",className:"btn btn-sm "+(e===n?"btn-dark":"btn-light"),onClick:()=>t(n)},a.props.title)))}function ce({view:e,children:t}){return c.createElement(_.Stack,{visible:e},t.map(((e,t)=>c.createElement(_.View,{key:t,name:t},e))))}var le=({children:e})=>{const[t,a]=l.exports.useState(0);return c.createElement("div",null,c.createElement("div",{className:`btn-group mr-2 mb-3 ${ie}`,role:"group","aria-label":"First group"},c.createElement(oe,{view:t,setView:a},e)),c.createElement(ce,{view:t},e))};var me="_mediaContainer_tulrq_1",de="_singleMedia_tulrq_6",ue="_formGroup_tulrq_25",pe=e=>c.createElement("div",null,c.createElement("form",null,c.createElement("div",{className:`form-group ${ue}`},c.createElement("label",{htmlFor:"exampleInputEmail1",className:"form-label"},"Title"),c.createElement("input",{type:"text",className:"form-control",id:"exampleInputEmail1",placeholder:"Video Title"})))),ve=({media:e})=>{const[t,a]=l.exports.useState("images"),n={},s=e=>{const t=[];for(let a=e%3;a<=3;a++)t.push(c.createElement("div",{key:`fake${a}`,className:"avatar avatar-lg avatar-4by3"}));return t};n.images=()=>{const t=e.images.map(((e,t)=>c.createElement("div",{key:t,className:`${de} avatar avatar-lg avatar-4by3`},c.createElement(j,{data:{type:"image",src:e.src},source:"sidebar",index:t},c.createElement("img",{src:e.thumb,className:"avatar-img rounded"}))))),a=s(e.images.length+1);return t.push(...a),t},n.videos=()=>{const t=e.videos.map(((e,t)=>c.createElement("div",{key:t,className:`${de} avatar avatar-lg avatar-4by3`},c.createElement(j,{data:{type:"video",src:e.src,poster:e.poster},source:"sidebar",index:t},c.createElement("video",{controls:!0,src:e.src,poster:e.poster,className:"avatar-img rounded"}))))),a=s(e.videos.length+1);return t.push(...a),t},n.audios=()=>e.audios.map(((e,t)=>c.createElement("div",{key:t,className:`${de}`},c.createElement(j,{data:{type:"audio",src:e.src},source:"sidebar",index:t},c.createElement("audio",{controls:!0,src:e.src})))));return c.createElement("div",null,c.createElement("div",{className:"form-group"},c.createElement("label",{htmlFor:"selectMediaType"},"Select media type"),c.createElement("select",{className:"custom-select",id:"selectMediaType",value:t,onChange:e=>a(e.target.value)},c.createElement("option",{value:"images"},"Photo"),c.createElement("option",{value:"videos"},"Video"),c.createElement("option",{value:"audios"},"Audio"))),c.createElement("div",{className:me},n[t]()))},ge=e=>c.createElement("div",null,c.createElement(le,null,c.createElement(ve,{media:O.media,title:"Media"}),c.createElement(pe,{title:"Settings"})));var Ee="_dashboardSidebar_109b2_1",fe=e=>c.createElement("div",{className:Ee},c.createElement(ge,null),c.createElement("div",{className:"btn-group btn-group-sm mr-2 mb-3"},c.createElement("button",{type:"button",className:"btn btn-light"},"Save"))),he=()=>{const{scenes:e,audio:t}=A();return c.createElement("div",null,c.createElement("div",{className:H},c.createElement(re,{scenes:[...e],audio:[...t]})),c.createElement(R,null))};var _e="_photoEdit_1u8nb_1";const[be,ye]=m(((e,t)=>({stage:null,addImage:function(e){var t=document.createElement("img");t.src=e;return new u.Image({image:t,x:0,y:0,width:500,height:500})},onLoad:function(e){var t=new u.Stage({container:`${_e}`,width:500,height:500}),a=new u.Layer;t.add(a),u.Image.fromURL(e,(function(e){e.setAttrs({x:0,y:0,width:500,height:500}),a.add(e),a.draw()}))}})));var we=({scene:e})=>(l.exports.useLayoutEffect((()=>{e&&ye.getState().onLoad(e.src)}),[e]),e?c.createElement("div",{id:_e}):null),xe=({scene:e})=>e?c.createElement(l.exports.Fragment,null,c.createElement("div",{className:"collapse navbar-collapse",id:"navbarVertical"})):null,Se=e=>c.createElement("div",null,"Video"),Ne=e=>c.createElement("div",null,"Video"),ke=e=>{const{view:t}=B();return c.createElement("div",null,c.createElement(y,{view:t},c.createElement(fe,{title:"Dashboard",name:"dashboard"}),c.createElement(xe,{title:"Photo Edit",name:"photo",scene:L.getState().scene,back:()=>L.setState({view:"dashboard"})}),c.createElement(Se,{title:"Video",name:"video",back:()=>L.setState({view:"dashboard"})})),c.createElement(x,{view:L.getState().view},c.createElement(he,{name:"dashboard"}),c.createElement(we,{name:"photo",scene:L.getState().scene}),c.createElement(Ne,{name:"video"})))};document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("root");p.render(c.createElement(ke,null),e)}));
